(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{158:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(26),i=a.n(o),l=(a(95),a(15)),c=a(16),s=a(19),u=a(17),m=a(20),d=(a(97),a(169)),p=a(159),h=a(160),E=a(36),v=a(18),g=a(7),f={USER_LOGGEDIN:"USER_LOGGEDIN",USER_LOGOUT:"USER_LOGOUT",FETCH_MOVIES:"FETCH_MOVIES",FETCH_MOVIE:"FETCH_MOVIE",SET_MOVIE:"SET_MOVIE",POST_REVIEW:"POST_REVIEW"},O=a(29),b=a.n(O);function j(e){var t=b()();return function(a){return fetch("".concat(t.REACT_APP_API_URL,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(t){var n;localStorage.setItem("username",e.username),localStorage.setItem("token",t.token),a((n=e.username,{type:f.USER_LOGGEDIN,username:n}))}).catch(function(e){return console.log(e)})}}function y(){return function(e){localStorage.removeItem("username"),localStorage.removeItem("token"),e({type:f.USER_LOGOUT})}}var I=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"logout",value:function(){this.props.dispatch(y())}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(d.a,null,r.a.createElement(d.a.Header,null,r.a.createElement(d.a.Brand,null,"Movie App")),r.a.createElement(p.a,null,r.a.createElement(E.LinkContainer,{to:"/movielist"},r.a.createElement(h.a,{eventKey:1,disabled:!this.props.loggedIn},"Movie List ")),r.a.createElement(E.LinkContainer,{to:"/movie/"+(this.props.selectedMovie?this.props.selectedMovie._id:"")},r.a.createElement(h.a,{eventKey:2,disabled:!this.props.loggedIn},"Movie Detail")),r.a.createElement(E.LinkContainer,{to:"/signin"},r.a.createElement(h.a,{eventKey:3},this.props.loggedIn?r.a.createElement("button",{onClick:this.logout.bind(this)},"Logout"):"Login")))),r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",{className:"App-title"},this.props.selectedMovie?this.props.selectedMovie.title:"")))}}]),t}(n.Component),w=Object(g.o)(Object(v.b)(function(e){return{loggedIn:e.auth.loggedIn,username:e.auth.username,selectedMovie:e.movie.selectedMovie}})(I)),k=a(12);function C(e){return function(t){t(function(e){return{type:f.SET_MOVIE,selectedMovie:e}}(e))}}function R(){var e=b()();return function(t){return fetch("".concat(e.REACT_APP_API_URL,"/movies?reviews=true"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:localStorage.getItem("token")},mode:"cors"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(e){var a;t((a=e,{type:f.FETCH_MOVIES,movies:a}))}).catch(function(e){return console.log(e)})}}function S(e){var t=b()();return function(a){return fetch("".concat(t.REACT_APP_API_URL,"/movies/").concat(e,"?reviews=true"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:localStorage.getItem("token")},mode:"cors"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(e){var t;a((t=e,{type:f.FETCH_MOVIE,selectedMovie:t}))}).catch(function(e){return console.log(e)})}}var T=a(161),M=a(170),_=a(38),L=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).handleClick=function(e){(0,a.props.dispatch)(C(e))},a.handleSelect=a.handleSelect.bind(Object(k.a)(Object(k.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.dispatch)(R())}},{key:"handleSelect",value:function(e,t){(0,this.props.dispatch)(C(this.props.movies[e]))}},{key:"render",value:function(){var e=this,t=function(t){var a=t.movieList;return a?r.a.createElement(M.a,{onSelect:e.handleSelect},a.map(function(t){return r.a.createElement(M.a.Item,{key:t.title},r.a.createElement("div",null,r.a.createElement(E.LinkContainer,{to:"/movie/"+t.title,onClick:function(){return e.handleClick(t)}},r.a.createElement(T.a,{className:"image",src:t.imageUrl,thumbnail:!0}))),r.a.createElement(M.a.Caption,null,r.a.createElement("h3",null,t.title),r.a.createElement(_.a,{glyph:"star"})," ",t.avgRating," \xa0\xa0 ",t.year))})):r.a.createElement("div",null,"Loading...")};return r.a.createElement(t,{movieList:this.props.movies})}}]),t}(n.Component),D=Object(v.b)(function(e){return{movies:e.movie.movies}})(L),A=a(162),P=a(163),U=a(164),N=a(165),G=a(171),V=a(166),x=a(168),F=a(167),H=a(157);function z(e){var t=b()(),a=[];for(var n in e){var r=encodeURIComponent(n),o=encodeURIComponent(e[n]);a.push(r+"="+o)}return a=a.join("&"),function(e){return fetch("".concat(t.REACT_APP_API_URL,"/reviews"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",Authorization:localStorage.getItem("token")},body:a,mode:"cors"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(t){var a;e((a=t,{type:f.POST_REVIEW,review:a}))}).catch(function(e){return console.log(e)})}}var B=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).updateReviewDetails=a.updateReviewDetails.bind(Object(k.a)(Object(k.a)(a))),a.postReview=a.postReview.bind(Object(k.a)(Object(k.a)(a))),a.state={details:{movieTitle:a.props.selectedMovie.title,reviewer:localStorage.getItem("username"),quote:"",rating:0}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"updateReviewDetails",value:function(e){var t=Object.assign({},this.state.details);t[e.target.id]=e.target.value,this.setState({details:t})}},{key:"postReview",value:function(){var e=this;(0,this.props.dispatch)(z(this.state.details)).then(function(){e.props.history.push("/")})}},{key:"componentDidMount",value:function(){var e=this.props.dispatch;null==this.props.selectedMovie&&e(S(this.props.movieId))}},{key:"render",value:function(){var e=this,t=function(e){return e.actorsName.map(function(e,t){return r.a.createElement("p",{key:t},r.a.createElement("b",null,e.actorName)," ",e.characterName)})},a=function(e){return e.reviews.map(function(e,t){return r.a.createElement("p",{key:t},r.a.createElement("b",null,e.username)," ",e.review," \xa0\xa0\xa0",r.a.createElement(_.a,{glyph:"star"})," ",e.rating)})},n=function(t){var a=t.currentMovie;return r.a.createElement(A.a,{horizontal:!0,key:"reviewForm"},r.a.createElement(P.a,{controlId:"rating",key:"ratingFormGroup"},r.a.createElement(U.a,{componentClass:N.a,sm:3},"Rating (0-5)"),r.a.createElement(U.a,{sm:9},r.a.createElement(G.a,{key:"ratingFormControl",onChange:e.updateReviewDetails,value:e.state.details.rating,type:"Number",min:"0",max:"5"}))),r.a.createElement(P.a,{controlId:"quote"},r.a.createElement(U.a,{componentClass:N.a,sm:3},"Comment"),r.a.createElement(U.a,{sm:9},r.a.createElement(G.a,{onChange:e.updateReviewDetails,value:e.state.details.quote,type:"text",placeholder:"Your Thoughts..."}))),r.a.createElement(P.a,{controlId:"movieTitle"},r.a.createElement(G.a,{type:"hidden",value:a.title,onLoad:e.updateReviewDetails})),r.a.createElement(P.a,{controlId:"reviewer"},r.a.createElement(G.a,{type:"hidden",value:localStorage.getItem("username"),onLoad:e.updateReviewDetails})),r.a.createElement(P.a,null,r.a.createElement(U.a,{smOffset:2,sm:10},r.a.createElement(V.a,{onClick:e.postReview},"Post Review"))))},o=function(e){var n=e.currentMovie;return n?r.a.createElement(x.a,null,r.a.createElement(x.a.Heading,{key:"movieDetailHeading"},"Movie Detail"),r.a.createElement(x.a.Body,{key:"movieImage"},r.a.createElement(T.a,{className:"image",src:n.imageUrl,thumbnail:!0})),r.a.createElement(F.a,{key:"movieDetailList"},r.a.createElement(H.a,null,n.title),r.a.createElement(H.a,null,r.a.createElement(t,{actors:n.actors})),r.a.createElement(H.a,null,r.a.createElement("h4",null,r.a.createElement(_.a,{glyph:"star"})," ",n.avgRating," "))),r.a.createElement(x.a.Body,null,r.a.createElement(a,{reviews:n.reviews}))):r.a.createElement("div",null,"Loading...")};return r.a.createElement("div",null,r.a.createElement(o,{currentMovie:this.props.selectedMovie}),r.a.createElement(n,{currentMovie:this.props.selectedMovie}))}}]),t}(n.Component),W=Object(g.o)(Object(v.b)(function(e,t){return console.log(t),{selectedMovie:e.movie.selectedMovie,title:t.match.params.title}})(B)),J=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).updateDetails=a.updateDetails.bind(Object(k.a)(Object(k.a)(a))),a.login=a.login.bind(Object(k.a)(Object(k.a)(a))),a.state={details:{username:"",password:""}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"updateDetails",value:function(e){var t=Object.assign({},this.state.details);t[e.target.id]=e.target.value,this.setState({details:t})}},{key:"login",value:function(){(0,this.props.dispatch)(j(this.state.details))}},{key:"render",value:function(){return r.a.createElement(A.a,{horizontal:!0},r.a.createElement(P.a,{controlId:"username"},r.a.createElement(U.a,{componentClass:N.a,sm:2},"Email"),r.a.createElement(U.a,{sm:10},r.a.createElement(G.a,{onChange:this.updateDetails,value:this.state.details.username,type:"email",placeholder:"Email"}))),r.a.createElement(P.a,{controlId:"password"},r.a.createElement(U.a,{componentClass:N.a,sm:2},"Password"),r.a.createElement(U.a,{sm:10},r.a.createElement(G.a,{onChange:this.updateDetails,value:this.state.details.password,type:"password",placeholder:"Password"}))),r.a.createElement(P.a,null,r.a.createElement(U.a,{smOffset:2,sm:10},r.a.createElement(V.a,{onClick:this.login},"Sign in"))))}}]),t}(n.Component),q=Object(v.b)(function(e){return{}})(J),K=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).updateDetails=e.updateDetails.bind(Object(k.a)(Object(k.a)(e))),e.register=e.register.bind(Object(k.a)(Object(k.a)(e))),e.state={details:{name:"",username:"",password:""}},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"updateDetails",value:function(e){var t=Object.assign({},this.state.details);t[e.target.id]=e.target.value,this.setState({details:t})}},{key:"register",value:function(){(0,this.props.dispatch)(function(e){var t=b()();return function(a){return fetch("".concat(t.REACT_APP_API_URL,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e),mode:"cors"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(t){a(j(e))}).catch(function(e){return console.log(e)})}}(this.state.details))}},{key:"render",value:function(){return r.a.createElement(A.a,{horizontal:!0},r.a.createElement(P.a,{controlId:"name"},r.a.createElement(U.a,{componentClass:N.a,sm:2},"Email"),r.a.createElement(U.a,{sm:10},r.a.createElement(G.a,{onChange:this.updateDetails,value:this.state.details.name,type:"text",placeholder:"Name"}))),r.a.createElement(P.a,{controlId:"username"},r.a.createElement(U.a,{componentClass:N.a,sm:2},"Email"),r.a.createElement(U.a,{sm:10},r.a.createElement(G.a,{onChange:this.updateDetails,value:this.state.details.username,type:"text",placeholder:"Username"}))),r.a.createElement(P.a,{controlId:"password"},r.a.createElement(U.a,{componentClass:N.a,sm:2},"Password"),r.a.createElement(U.a,{sm:10},r.a.createElement(G.a,{onChange:this.updateDetails,value:this.state.details.password,type:"password",placeholder:"Password"}))),r.a.createElement(P.a,null,r.a.createElement(U.a,{smOffset:2,sm:10},r.a.createElement(V.a,{onClick:this.register},"Register"))))}}]),t}(n.Component),Y=Object(v.b)(function(e){return{}})(K),$=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this))).state={toggleReg:!1},e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"showLogin",value:function(){this.setState({toggleReg:!1})}},{key:"showReg",value:function(){this.setState({toggleReg:!0})}},{key:"logout",value:function(){this.props.dispatch(y())}},{key:"render",value:function(){var e=r.a.createElement("div",null,r.a.createElement("button",{onClick:this.showLogin.bind(this)},"Login"),r.a.createElement("button",{onClick:this.showReg.bind(this)},"Register"),this.state.toggleReg?r.a.createElement(Y,null):r.a.createElement(q,null)),t=r.a.createElement("div",null,"Logged in as: ",this.props.username," ",r.a.createElement("button",{onClick:this.logout.bind(this)},"Logout"));return r.a.createElement("div",null,this.props.loggedIn?t:e)}}]),t}(n.Component),Q=Object(v.b)(function(e){return{loggedIn:e.auth.loggedIn,username:e.auth.username}})($),X=a(33),Z=a(37),ee=a(89),te={loggedIn:!!localStorage.getItem("token"),username:localStorage.getItem("username")?localStorage.getItem("username"):""},ae={movies:[],selectedMovie:null},ne=[ee.a],re=Object(Z.d)(Object(Z.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0,a=Object.assign({},e);switch(t.type){case f.USER_LOGGEDIN:return a.loggedIn=!0,a.username=t.username,a;case f.USER_LOGOUT:return a.loggedIn=!1,a.username="",a;default:return e}},movie:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0,a=Object.assign({},e);switch(t.type){case f.FETCH_MOVIES:return a.movies=t.movies,a.selectedMovie=t.movies[0],a;case f.SET_MOVIE:case f.FETCH_MOVIE:return a.selectedMovie=t.selectedMovie,a;default:return e}}}),Z.a.apply(void 0,ne)),oe=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(v.a,{store:re},r.a.createElement(X.HashRouter,null,r.a.createElement("div",null,r.a.createElement(w,null),r.a.createElement(g.d,{exact:!0,path:"/",render:function(){return r.a.createElement(D,null)}}),r.a.createElement(g.d,{path:"/movielist",render:function(){return r.a.createElement(D,null)}}),r.a.createElement(g.d,{path:"/movie/:Movie_title",render:function(){return r.a.createElement(W,null)}}),r.a.createElement(g.d,{path:"/signin",render:function(){return r.a.createElement(Q,null)}})))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(oe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},90:function(e,t,a){e.exports=a(158)},95:function(e,t,a){},97:function(e,t,a){}},[[90,2,1]]]);
//# sourceMappingURL=main.9373a1f3.chunk.js.map